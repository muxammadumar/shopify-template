<!doctype html>
<html lang="{{ request.locale.iso_code }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>
      {%- if page_title -%}{{ page_title }}{%- else -%}{{ shop.name }}{%- endif -%}
      {%- if current_tags -%} &mdash; {{ current_tags | join: ', ' }}{%- endif -%}
      {%- if current_page != 1 -%} &mdash; {{ 'general.pagination.page' | t: number: current_page }}{%- endif -%}
      {%- unless page_title contains shop.name -%} &mdash; {{ shop.name }}{%- endunless -%}
    </title>

    {%- if page_description -%}
      <meta name="description" content="{{ page_description | escape }}">
    {%- else -%}
      <meta name="description" content="{{ 'meta.description' | t }}">
    {%- endif -%}

    <link rel="canonical" href="{{ canonical_url }}">

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | img_url: '32x32' }}">
      <link rel="apple-touch-icon" href="{{ settings.favicon | img_url: '180x180' }}">
    {%- endif -%}

    {%- comment -%} Preconnect for performance {%- endcomment -%}
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.shopify.com">

    {%- comment -%} Open Graph / Facebook Meta Tags {%- endcomment -%}
    <meta property="og:site_name" content="{{ shop.name }}">
    <meta property="og:url" content="{{ canonical_url }}">
    <meta property="og:title" content="{%- if page_title -%}{{ page_title }}{%- else -%}{{ shop.name }}{%- endif -%}">
    <meta property="og:type" content="website">
      <meta property="og:description" content="{%- if page_description -%}{{ page_description | escape }}{%- else -%}{{ 'meta.description' | t }}{%- endif -%}">
    {%- if page_image -%}
      <meta property="og:image" content="http:{{ page_image | img_url: '1200x630' }}">
      <meta property="og:image:secure_url" content="https:{{ page_image | img_url: '1200x630' }}">
      <meta property="og:image:width" content="1200">
      <meta property="og:image:height" content="630">
      <meta property="og:image:alt" content="{%- if page_title -%}{{ page_title | escape }}{%- else -%}{{ shop.name | escape }}{%- endif -%}">
    {%- endif -%}
    <meta property="og:locale" content="{{ request.locale.iso_code }}_{{ request.locale.iso_code | upcase }}">

    {%- comment -%} Twitter Card Meta Tags {%- endcomment -%}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{%- if page_title -%}{{ page_title }}{%- else -%}{{ shop.name }}{%- endif -%}">
      <meta name="twitter:description" content="{%- if page_description -%}{{ page_description | escape }}{%- else -%}{{ 'meta.description_short' | t }}{%- endif -%}">
    {%- if page_image -%}
      <meta name="twitter:image" content="https:{{ page_image | img_url: '1200x630' }}">
    {%- endif -%}

    {%- comment -%} Structured Data (JSON-LD) for SEO {%- endcomment -%}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "{{ shop.name }}",
      "url": "{{ shop.url }}",
      "logo": "{{ 'logo.png' | asset_url }}",
      "description": "{{ 'meta.description' | t }}",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "DE"
      },
      "sameAs": []
    }
    </script>

    {%- if template == 'index' -%}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "{{ shop.name }}",
      "url": "{{ shop.url }}",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "{{ shop.url }}/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    {%- endif -%}

    {{ content_for_header }}

    {%- comment -%} Theme CSS with font optimization {%- endcomment -%}
    <style>
      /* Critical CSS for font loading */
      @font-face {
        font-family: system-ui;
        font-display: swap;
      }
    </style>
    {{ 'ios.css' | asset_url | stylesheet_tag }}
    
    {%- comment -%} Theme JavaScript - modularized for better performance {%- endcomment -%}
    <script src="{{ 'smooth-scroll.js' | asset_url }}" defer></script>
    <script src="{{ 'mobile-menu.js' | asset_url }}" defer></script>
    <script src="{{ 'faq-accordion.js' | asset_url }}" defer></script>
    <script src="{{ 'country-selector.js' | asset_url }}" defer></script>
    <script src="{{ 'cookie-banner.js' | asset_url }}" defer></script>
    <script src="{{ 'language-selector.js' | asset_url }}" defer></script>
    <script src="{{ 'main.js' | asset_url }}" defer></script>

    {%- comment -%} Theme Color Variables {%- endcomment -%}
    <style>
      :root{
        --rolex-emerald: {{ settings.rolex_emerald | default: '#0F5132' }};
        --rolex-gold: {{ settings.rolex_gold | default: '#C9A227' }};
        --rolex-bg: {{ settings.rolex_bg | default: '#040B07' }};
      }
    </style>

    {%- comment -%} Theme color for browser chrome {%- endcomment -%}
    <meta name="theme-color" content="#040B07">
    <meta name="msapplication-TileColor" content="#040B07">
  </head>

  <body>
    {%- comment -%} Skip to content link for accessibility {%- endcomment -%}
    <a class="ios-skip" href="#MainContent">{{ 'general.skip_to_content' | t }}</a>

    <main id="MainContent" role="main">
      {{ content_for_layout }}
    </main>

    {%- comment -%} Cookie Consent Banner (GDPR Requirement for Germany) {%- endcomment -%}
    {%- if settings.cookie_banner_enabled != false -%}
    <div id="iosCookieBanner" class="ios-cookie-banner" role="dialog" aria-labelledby="iosCookieBannerTitle" aria-modal="true">
      <div class="ios-wrap">
        <div class="ios-cookie-content">
          <div class="ios-cookie-text">
            <strong id="iosCookieBannerTitle">{{ 'cookie_banner.title' | t }}</strong><br>
            {%- if settings.cookie_banner_text != blank -%}{{ settings.cookie_banner_text }}{%- else -%}{{ 'cookie_banner.text' | t }}{%- endif -%} 
            {{ 'cookie_banner.agreement' | t }} 
            {%- assign privacy_url = settings.privacy_policy_url | default: '' -%}
            {%- assign imprint_url = settings.imprint_url | default: '' -%}
            {%- if privacy_url != blank and privacy_url != '#' -%}
              <a href="{{ privacy_url }}" target="_blank">{{ 'cookie_banner.privacy_policy' | t }}</a>
            {%- else -%}
              {{ 'cookie_banner.privacy_policy' | t }}
            {%- endif -%}
            {%- if privacy_url != blank and privacy_url != '#' and imprint_url != blank and imprint_url != '#' -%} {{ 'cookie_banner.and' | t }} {%- endif -%}
            {%- if imprint_url != blank and imprint_url != '#' -%}
              <a href="{{ imprint_url }}" target="_blank">{{ 'cookie_banner.imprint' | t }}</a>
            {%- else -%}
              {{ 'cookie_banner.imprint' | t }}
            {%- endif -%}
            {{ 'cookie_banner.agree' | t }}
          </div>
          <div class="ios-cookie-actions">
            <button id="declineCookies" class="ios-btn ghost">{{ 'general.decline' | t }}</button>
            <button id="acceptCookies" class="ios-btn primary">{{ 'general.accept' | t }}</button>
          </div>
        </div>
      </div>
    </div>
    {%- endif -%}

    {%- comment -%} Detect if CSS custom properties are supported {%- endcomment -%}
    <script>
      (function(){
        var supportsCustomProps = window.CSS && window.CSS.supports && window.CSS.supports('(--a: 0)');
        if(!supportsCustomProps){
          document.documentElement.className += ' no-cssvar';
        }
      })();
    </script>
  </body>
</html>
